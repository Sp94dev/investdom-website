---
import Container from "../ui/Container.astro";
import Button from "../ui/Button.astro";
---

<section
  id="kontakt"
  class="py-24 bg-navy-900 text-stone-100 relative overflow-hidden"
>
  <!-- Decorative background elements -->
  <div
    class="absolute top-0 right-0 w-1/3 h-full bg-navy-800/30 skew-x-12 transform translate-x-1/2"
  >
  </div>
  <div
    class="absolute bottom-0 left-0 w-64 h-64 bg-navy-800/20 rounded-full blur-3xl transform -translate-x-1/2 translate-y-1/2"
  >
  </div>

  <Container class="relative z-10">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16">
      <!-- Contact Info -->
      <div class="space-y-10">
        <div>
          <h2
            class="font-heading font-bold text-3xl md:text-5xl text-white mb-6"
          >
            Skontaktuj się z nami
          </h2>
          <p class="text-stone-300 text-lg leading-relaxed max-w-md">
            Chcesz kupić dom lub zlecić budowę? Zadzwoń do nas lub napisz.
            Umówimy się na spotkanie i obejrzenie inwestycji.
          </p>
        </div>

        <div class="space-y-6">
          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-navy-800 rounded-lg flex items-center justify-center shrink-0"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-sky-300"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"
                ></path>
              </svg>
            </div>
            <div>
              <p class="text-stone-400 text-sm uppercase tracking-wider mb-1">
                Zadzwoń do nas (inż. Budownictwa)
              </p>
              <a
                href="tel:+48571328983"
                class="text-2xl font-bold text-white hover:text-sky-300 transition-colors"
              >
                +48 571 328 983
              </a>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-navy-800 rounded-lg flex items-center justify-center shrink-0"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-sky-300"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"
                ></path>
              </svg>
            </div>
            <div>
              <p class="text-stone-400 text-sm uppercase tracking-wider mb-1">
                Napisz e-mail
              </p>
              <a
                href="mailto:kontakt@investdom.com.pl"
                class="text-xl font-medium text-white hover:text-sky-300 transition-colors"
              >
                kontakt@investdom.com.pl
              </a>
              <p class="text-stone-400 text-sm mt-1">Odpowiadamy w 24h</p>
            </div>
          </div>

          <div class="flex items-start gap-4">
            <div
              class="w-12 h-12 bg-navy-800 rounded-lg flex items-center justify-center shrink-0"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="w-6 h-6 text-sky-300"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"
                ></path>
              </svg>
            </div>
            <div>
              <p class="text-stone-400 text-sm uppercase tracking-wider mb-1">
                Biuro
              </p>
              <p class="text-lg text-white">ul. Na Lasu 25</p>
              <p class="text-stone-300">43-300 Bielsko-Biała</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Contact Form -->
      <div class="bg-white p-8 rounded-2xl shadow-xl">
        <h3 class="font-heading font-bold text-2xl text-navy-900 mb-6">
          Wyślij wiadomość
        </h3>
        <div id="form-container">
          <form
            id="contact-form"
            action="https://api.web3forms.com/submit"
            method="POST"
            class="space-y-6"
          >
            <input
              type="hidden"
              name="access_key"
              value="3eeaf9f0-96bb-4cf5-abfc-a0b6e29c82c6"
            />
            <input
              type="hidden"
              name="subject"
              value="Nowa wiadomość z formularza InvestDom"
            />
            <input
              type="checkbox"
              name="botcheck"
              class="hidden"
              style="display: none;"
            />

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label
                  for="name"
                  class="block text-sm font-medium text-slate-700 mb-2"
                  >Imię i nazwisko</label
                >
                <input
                  type="text"
                  id="name"
                  name="name"
                  required
                  class="w-full px-4 py-3 rounded-lg bg-stone-50 border border-stone-200 focus:border-navy-900 focus:ring-1 focus:ring-navy-900 outline-none text-navy-900 transition-colors"
                  placeholder="Jan Kowalski"
                />
              </div>
              <div>
                <label
                  for="phone"
                  class="block text-sm font-medium text-slate-700 mb-2"
                  >Telefon</label
                >
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  required
                  class="w-full px-4 py-3 rounded-lg bg-stone-50 border border-stone-200 focus:border-navy-900 focus:ring-1 focus:ring-navy-900 outline-none text-navy-900 transition-colors"
                  placeholder="+48 123 456 789"
                />
              </div>
            </div>

            <div>
              <label
                for="email"
                class="block text-sm font-medium text-slate-700 mb-2"
                >Email</label
              >
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-4 py-3 rounded-lg bg-stone-50 border border-stone-200 focus:border-navy-900 focus:ring-1 focus:ring-navy-900 outline-none text-navy-900 transition-colors"
                placeholder="jan@example.com"
              />
            </div>

            <div>
              <label
                for="subject"
                class="block text-sm font-medium text-slate-700 mb-2"
                >Temat</label
              >
              <select
                id="subject-select"
                name="temat_wybrany"
                class="w-full px-4 py-3 rounded-lg bg-stone-50 border border-stone-200 focus:border-navy-900 focus:ring-1 focus:ring-navy-900 outline-none text-navy-900 transition-colors"
              >
                <option value="kupno">Chcę kupić dom</option>
                <option value="budowa">Zlecenie budowy domu</option>
                <option value="remont">Remont / Wykończenie</option>
                <option value="inne">Inne zapytanie</option>
              </select>
            </div>

            <div>
              <label
                for="message"
                class="block text-sm font-medium text-slate-700 mb-2"
                >Wiadomość</label
              >
              <textarea
                id="message"
                name="message"
                rows="4"
                required
                class="w-full px-4 py-3 rounded-lg bg-stone-50 border border-stone-200 focus:border-navy-900 focus:ring-1 focus:ring-navy-900 outline-none text-navy-900 transition-colors"
                placeholder="Napisz, czym możemy Ci pomóc..."></textarea>
            </div>

            <div id="result" class="text-center text-sm font-medium hidden">
            </div>

            <Button
              type="submit"
              variant="primary"
              id="submit-btn"
              class="w-full justify-center"
            >
              Wyślij wiadomość
            </Button>
          </form>
        </div>

        <script is:inline>
          const form = document.getElementById("contact-form");
          const result = document.getElementById("result");
          const submitBtn = document.getElementById("submit-btn");
          const originalBtnText = submitBtn.innerText;

          form.addEventListener("submit", function (e) {
            e.preventDefault();
            const formData = new FormData(form);
            const object = Object.fromEntries(formData);
            const json = JSON.stringify(object);

            result.classList.add("hidden");
            result.classList.remove("text-green-600", "text-red-600");
            submitBtn.innerText = "Wysyłanie...";
            submitBtn.disabled = true;
            submitBtn.classList.add("opacity-75", "cursor-not-allowed");

            fetch("https://api.web3forms.com/submit", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
                Accept: "application/json",
              },
              body: json,
            })
              .then(async (response) => {
                let json = await response.json();
                if (response.status == 200) {
                  result.innerText =
                    "Dziękujemy! Wiadomość została wysłana pomyślnie.";
                  result.classList.remove("hidden");
                  result.classList.add("text-green-600");
                  form.reset();
                } else {
                  console.log(response);
                  result.innerText =
                    json.message ||
                    "Coś poszło nie tak. Spróbuj ponownie później.";
                  result.classList.remove("hidden");
                  result.classList.add("text-red-600");
                }
              })
              .catch((error) => {
                console.log(error);
                result.innerText = "Wystąpił błąd. Spróbuj ponownie później.";
                result.classList.remove("hidden");
                result.classList.add("text-red-600");
              })
              .finally(() => {
                submitBtn.innerText = originalBtnText;
                submitBtn.disabled = false;
                submitBtn.classList.remove("opacity-75", "cursor-not-allowed");
                setTimeout(() => {
                  result.style.display = "none";
                  result.classList.add("hidden");
                }, 5000);
              });
          });
        </script>
      </div>
    </div>
  </Container>
</section>
